#+TITLE: Install Open Vino on MacOS
#+OPTIONS: ^:nil
#+Include: ../purpleweb.org

* Uninstallation OpenVino on Mac
- åŸ·è¡Œopenvino_toolkit_uninstaller.app: /opt/intel/openvino_2021

* Installation step by step
1. Install cmake
   - æ±è¥¿åœ¨ NAS
2. Add /Applications/CMake.app/Contents/bin to path (for default install)
   edit .bashrc file,åŠ å…¥
   #+begin_src shell -r -n :results output :exports both
   export PATH="/Applications/CMake.app/Contents/bin:$PATH"
   #+end_src
3. Install openvino tool kit
   - NAS
4. vi ~/.bash_profile
   åŠ å…¥
   #+begin_src shell -r -n :results output :exports both
   source /opt/intel/openvino_2021/bin/setupvars.sh
   #+end_src
5. Configure the Model OptimizerÂ¶
   #+begin_src shell -r -n :results output :exports both
   cd /opt/intel/openvino_2021/deployment_tools/model_optimizer/install_prerequisites
   sudo ./install_prerequisites.sh
   #+end_src
6. Upgrade PyYAML
   #+begin_src shell -r -n :results output :exports both
   sudo -H pip3 install --ignore-installed PyYAML
   #+end_src
7. Testing
   #+begin_src shell -r -n :results output :exports both
   cd /opt/intel/openvino_2021/deployment_tools/demo
   sh demo_benchmark_app.sh
   sh demo_security_barrier_camera.sh
   sh demo_squeezenet_download_convert_run.sh
   #+end_src
   8. Install cv2
   #+begin_src shell -r -n :results output :exports both
pip3 install --user opencv-python
   #+end_src

   #+RESULTS:
   : Collecting opencv-python
   :   Using cached https://files.pythonhosted.org/packages/8b/9f/879a48a4d4361d1784728be8543f5c8b2b681db500c9e6854f0654645c3d/opencv_python-4.5.4.58-cp37-cp37m-macosx_10_15_x86_64.whl
   : Collecting numpy>=1.14.5 (from opencv-python)
   :   Using cached https://files.pythonhosted.org/packages/5d/e4/1178a2e82d1c9abd696496d4f0fc2d09e346b43101829e08eb3ee558fd5d/numpy-1.21.4-cp37-cp37m-macosx_10_9_x86_64.whl
   : Installing collected packages: numpy, opencv-python
   : Successfully installed numpy-1.21.4 opencv-python-4.5.4.58

9. copy openvino to site_package
   #+begin_src shell -r -n :results output :exports both
cd /Users/letranger/opt/anaconda3/lib/python3.8/site-packages
cp -r /opt/intel/openvino_2021.4.689/python/python3.8/openvino .
   #+end_src

   #+RESULTS:

* Intall OpenVino by Docker
** Introduction
- ä¸€èˆ¬å¤§å®¶è²·ä¾†çš„é›»è…¦ä¸Šå¤§éƒ¨ä»½éƒ½æ˜¯å®‰è£å¾®è»Ÿçš„Windowsä½œæ¥­ç³»çµ±ï¼Œå¦‚æœé‡åˆ°è¦é–‹ç™¼Liunxç›¸é—œæ‡‰ç”¨ç¨‹å¼æ™‚ï¼Œå¯èƒ½æœ‰äººæœƒé¸æ“‡å®‰è£äºŒå€‹ä½œæ¥­ç³»çµ±ï¼Œåœ¨é‡æ–°é–‹æ©Ÿæ™‚é¸æ“‡è¦åŸ·è¡Œé‚£ä¸€ç¨®ã€‚é›–ç„¶é€™ç¨®æ–¹å¼å¯å®Œå…¨æŒæ§ç¡¬é«”è³‡æºï¼ˆå¦‚CPU, GPU, HDD, RAMï¼‰åŠé–‹ç™¼ç’°å¢ƒï¼ˆç›¸ä¾å¥—ä»¶ã€å‡½å¼åº«ï¼‰ï¼Œä½†æ¯æ¬¡åˆ‡æ›ä½œæ¥­ç³»çµ±éƒ½è¦é‡æ–°é–‹æ©Ÿï¼Œå¯¦åœ¨å¤ªéº»ç…©ã€‚
- ç‚ºè§£æ±ºé€™å€‹å•é¡Œï¼Œæ–¼æ˜¯å°±æœ‰äººæå‡ºåœ¨ä¸»ä½œæ¥­ç³»çµ±(Host OS)ä¸Šå®‰è£ä¸€å€‹è™›æ“¬æ©Ÿ(Virtual Machine, VM)ç›£è¦–å™¨(Hypervisor)ï¼Œå¦‚VMWare, VirtualBoxé€™é¡å·¥å…·ï¼Œæ–¹ä¾¿å®‰è£å…¶å®ƒä½œæ¥­ç³»çµ±æˆ–è€…å¤šç¨®ä¸åŒçš„é–‹ç™¼ç’°å¢ƒï¼Œå¦‚Fig. 1å·¦åœ–æ‰€ç¤ºã€‚é›–ç„¶é€™æ¨£å¾ˆæ–¹ä¾¿åŒæ™‚ä½¿ç”¨å…©ç¨®ä»¥ä¸Šä½œæ¥­ç’°å¢ƒï¼Œä½†ç¡¬é«”è³‡æºè¦å’Œä¸»ç³»çµ±å…±äº«ä¸”é¡å¤–å¤šäº†ä¸€äº›è™›æ“¬åŒ–è½‰æ›å·¥ä½œï¼Œæ‰€ä»¥åŸ·è¡Œæ•ˆèƒ½è¼ƒå·®ï¼Œç”šè‡³æœ‰äº›ç¡¬é«”ï¼ˆå¦‚GPUï¼‰ç„¡æ³•ç›´æ¥ä½¿ç”¨ï¼Œå°è‡´éƒ¨ä»½æ‡‰ç”¨ç¨‹å¼ç„¡æ³•é‹ä½œã€‚
- å¾ˆå¤šåœ¨Linuxç’°å¢ƒä¸‹é–‹ç™¼ç¨‹å¼çš„äººéƒ½çŸ¥é“ï¼Œå®ƒçš„æ‡‰ç”¨ç¨‹å¼æ¯”è¼ƒä¸åƒåœ¨Windowsä¸‹ä¸€å€‹åŸ·è¡Œæª”(.exe)æˆ–æ­é…å¹¾å€‹å‹•æ…‹å‡½å¼åº«(.dll)å°±èƒ½é †åˆ©åŸ·è¡Œï¼Œå„ç¨®é–‹ç™¼å·¥å…·åŠç›¸ä¾å¥—ä»¶åŒ…å¸¸æœƒæœ‰ç‰ˆæœ¬ä¸ç›¸å®¹å•é¡Œã€‚æœ¬ä¾†åœ¨Linuxä¸Šä¹Ÿå¯ä»¥åŸ·è¡Œè™›æ“¬æ©Ÿ(VM)ä¾†å€éš”ä¸åŒé–‹ç™¼ç’°å¢ƒï¼Œä½†æ•ˆèƒ½å¯¦åœ¨å¤ªå·®ï¼Œæ‰€ä»¥ä¾¿æœ‰äººé–‹ç™¼å‡ºä»¥ä¸€ç¨®é¡ä¼¼å¤§èˆ¹è¼‰é€è²¨æ«ƒï¼Œè²¨æ«ƒè£è¼‰å„ç¨®ä¸åŒå¤§å°ã€å½¢ç‹€è²¨ç‰©çš„åŸ·è¡Œç’°å¢ƒï¼Œç¨±ç‚ºDockerã€‚
- å¦‚åœ–[[fig:DockerVM]]æ‰€ç¤ºï¼Œå®¹å™¨(Containers)å°±åƒè²¨æ«ƒæ˜¯ç”¨ä¾†è£è¼‰æ˜ åƒæª”(Images)é€™æ¨£çš„è²¨ç‰©ï¼Œå†ç”±Dockerå¼•æ“ï¼ˆå¤§èˆ¹æ‰¿è¼‰ï¼‰åŸ·è¡Œçš„æ¦‚å¿µã€‚è¡¨é¢ä¸Šçœ‹èµ·ä¾†å’ŒVMæ²’ä»€éº¼ä¸åŒï¼Œä½†æœ€å¤§å·®åˆ¥å°±æ˜¯å®ƒå¾ˆè¼•é‡ï¼Œä¸é€éè™›æ“¬åŒ–ï¼Œç›´æ¥é©…å‹•ç¡¬é«”è³‡æºï¼Œå…±ç”¨ä½œæ¥­ç³»çµ±è³‡æºï¼Œæ‰€ä»¥å•Ÿç”¨ä¸€å€‹å®¹å™¨å’Œæ˜ åƒæª”åƒ…é ˆæ•¸ç§’å’Œè¼‰å…¥ä¸€å€‹VMå®¢ä½œæ¥­ç³»çµ±æ ¸å¿ƒè¦æ•¸åˆ†é˜å·®ç•°é —å¤§ã€‚ä»¥å¾€Dockeråªèƒ½åœ¨Linuxä¸Šé‹ä½œï¼Œè¿‘å¹´ä¾†å·²æœ‰æ”¯æ´WindowåŠMac OSçš„ç‰ˆæœ¬å‡ºç¾äº†ã€‚
- ä¸€èˆ¬Dockerä½¿ç”¨ä¸Šæ¥µç‚ºæ–¹ä¾¿ï¼Œä¾›æ‡‰å•†åƒ…éœ€å°‡æ¬²æä¾›çš„æ˜ åƒæª”(Images)æ¨ä¸Š(Push) å…¬é–‹æ˜ åƒæª”å€‰å„²(Repository / Docker Hub)ï¼Œä½¿ç”¨è€…å†å»æ‹‰ä¸‹(Pull)æƒ³è¦çš„æ˜ åƒæª”å³å¯åŸ·è¡Œï¼Œå¦‚åœ–[[fig:DockerVM]]å³åœ–æ‰€ç¤ºã€‚
#+CAPTION: VMå’ŒDockeræ¶æ§‹å·®ç•°æ¯”è¼ƒåœ–ã€‚(OmniXRI, Jan. 2021æ•´ç†è£½ä½œ)
#+LABEL:fig:DockerVM
#+name: fig:DockerVM
#+ATTR_LATEX: :width 400
#+ATTR_ORG: :width 400
#+ATTR_HTML: :width 500
[[file:images/OpenVINO_Docker_1.jpg]]
** Install Docker
1. Install Docker on Mac
   #+begin_src shell -r -n :results output :exports both
   brew install --cask  --appdir=/Applications docker
   #+end_src

   #+RESULTS:
   #+begin_example
   ==> Downloading https://desktop.docker.com/mac/main/amd64/70708/Docker.dmg
   ==> Installing Cask docker
   ==> Moving App 'Docker.app' to '/Applications/Docker.app'
   ==> Linking Binary 'docker-compose.bash-completion' to '/usr/local/etc/bash_completion.d/docker-compose'
   ==> Linking Binary 'docker.zsh-completion' to '/usr/local/share/zsh/site-functions/_docker'
   ==> Linking Binary 'docker.fish-completion' to '/usr/local/share/fish/vendor_completions.d/docker.fish'
   ==> Linking Binary 'docker-compose.fish-completion' to '/usr/local/share/fish/vendor_completions.d/docker-compose.fish'
   ==> Linking Binary 'docker-compose.zsh-completion' to '/usr/local/share/zsh/site-functions/_docker_compose'
   ==> Linking Binary 'docker.bash-completion' to '/usr/local/etc/bash_completion.d/docker'
   ğŸº  docker was successfully installed!
   #+end_example

2. Pull from Github
** Testing Docker
#+begin_src shell -r -n :results output :exports both
docker run hello-world
#+end_src
ç”±æ–¼ç¬¬ä¸€æ¬¡åŸ·è¡Œï¼Œæœ¬æ©Ÿç«¯ä¸¦æ²’hello-worldé€™å€‹æ˜ åƒæª”ï¼Œæ‰€ä»¥æœƒè‡ªå‹•åˆ°Docker Hubå»æ‰¾ï¼Œä¸¦ä¸‹è¼‰å›ä¾†ã€‚å¦‚æœæˆåŠŸæœƒçœ‹åˆ°ä¸‹é¢ç•«é¢ã€‚
** ä½¿ç”¨ Docker å®‰è£ OpenVINO
- Intel OpenVINO å°æ‡‰ä¸åŒæ“ä½œç³»çµ±(Windows, Linux, macOS, RaspbianOS)æä¾›å¾ˆå¤šç¨®å®‰è£æ–¹å¼ã€‚è¿‘å¹´ä¾†éš¨è‘—å„ç¨®å®¹å™¨æŠ€è¡“èˆˆèµ·ï¼Œä¹Ÿé–‹å§‹æ”¯æŒåƒ Docker é€™é¡ç›´æ¥å®‰è£æ˜ åƒæ–¹å¼ï¼Œå……ä»½è§£æ±ºç”¨æˆ¶ä¸ç†Ÿæ‚‰å®‰è£æ­¥é©ŸåŠæ»¿è¶³é–‹ç™¼è€…éœ€è¦ä¸åŒç‰ˆæœ¬æˆ–é–‹ç™¼ç’°å¢ƒéš”é›¢éœ€æ±‚ã€‚
- Intel OpenVINO ç›®å‰åœ¨ Docker Hub ä¸Šæä¾›äº†å¤šå€‹æ˜ åƒè®“ä½¿ç”¨è€…ä¸‹è¼‰(pull)ï¼Œå…¶ä¸­æœ‰å…©çµ„ä½¿ç”¨ç‡è¼ƒé«˜ï¼Œopenvino/workbench ç”¨æˆ¶ä¸éœ€ç·¨ç¨‹ï¼Œç›´æ¥æ“ä½œåœ–å‹åŒ–æ¥å£å°±å¯æ¸¬è©¦å„ç¨®æ¨¡å‹çš„æ•ˆç‡ï¼Œopenvino/ubuntu18_dev å‰‡æä¾›ä¸€èˆ¬ Ubuntu 18.04 (Linux) é–‹ç™¼ç’°å¢ƒã€‚
- é¦–å…ˆåŸ·è¡Œä¸‹åˆ—æŒ‡ä»¤å°‡æ˜ åƒæ–‡ä»¶ openvino/ubuntu18_dev å¾ Docker Hub æ‹‰ä¸‹ï¼ˆä¸‹è¼‰ï¼‰è‡³æœ¬æ©Ÿç«¯ã€‚ç”±æ–¼æ–‡ä»¶æ•¸é‡è¼ƒå¤šä¸”è¼ƒå¤§ï¼ˆè§£å£“ç¸®å¾Œç´„ 7.22GByteï¼‰ï¼Œæ‰€ä»¥æ ¹æ“šç¶²çµ¡é€Ÿåº¦å¯èƒ½éœ€è¦ç­‰å¾…æ•¸åˆ†é˜åˆ°æ•¸ååˆ†é¾ä¸ç­‰ã€‚
*** ä¸‹è¼‰ã€åŸ·è¡Œimage
#+begin_src shell -r -n :results output :exports both
docker pull openvino/ubuntu18_dev
#+end_src
è‹¥æƒ³å•Ÿå‹•æ˜ åƒæ–‡ä»¶ï¼Œæ ¹æ“šä¸åŒç¡¬ä»¶åŸ·è¡Œä¸‹åˆ—å‘½ä»¤ã€‚
- Intel CPU
#+begin_src shell -r -n :results output :exports both
docker run -it --rm openvino/ubuntu18_dev
#+end_src
- Intel GPU
#+begin_src shell -r -n :results output :exports both
docker run -it --rm --device /dev/dri openvino/ubuntu18_dev
#+end_src
- NCS2ï¼ˆå–®å€‹ VPUï¼‰
#+begin_src shell -r -n :results output :exports both
docker run -it --rm --device-cgroup-rule='c 189:* rmw' -v /dev/bus/usb:/dev/bus/usb openvino/ubuntu18_dev
#+end_src
- HDDLï¼ˆå¤šå€‹ VPUï¼‰
#+begin_src shell -r -n :results output :exports both
docker run -it --rm --device=/dev/ion:/dev/ion -v /var/tmp:/var/tmp openvino/ubuntu18_dev
#+end_src
** Dockerå¸¸ç”¨æŒ‡ä»¤
- docker info
  #+begin_src shell -r -n :results output :exports both
  docker info
  #+end_src

  #+RESULTS:
  #+begin_example
  Client:
   Context:    default
   Debug Mode: false
   Plugins:
    buildx: Build with BuildKit (Docker Inc., v0.6.3)
    compose: Docker Compose (Docker Inc., v2.1.1)
    scan: Docker Scan (Docker Inc., 0.9.0)

  Server:
   Containers: 4
    Running: 1
    Paused: 0
    Stopped: 3
   Images: 3
   Server Version: 20.10.10
   Storage Driver: overlay2
    Backing Filesystem: extfs
    Supports d_type: true
    Native Overlay Diff: true
    userxattr: false
   Logging Driver: json-file
   Cgroup Driver: cgroupfs
   Cgroup Version: 1
   Plugins:
    Volume: local
    Network: bridge host ipvlan macvlan null overlay
    Log: awslogs fluentd gcplogs gelf journald json-file local logentries splunk syslog
   Swarm: inactive
   Runtimes: io.containerd.runc.v2 io.containerd.runtime.v1.linux runc
   Default Runtime: runc
   Init Binary: docker-init
   containerd version: 5b46e404f6b9f661a205e28d59c982d3634148f8
   runc version: v1.0.2-0-g52b36a2
   init version: de40ad0
   Security Options:
    seccomp
     Profile: default
   Kernel Version: 5.10.47-linuxkit
   Operating System: Docker Desktop
   OSType: linux
   Architecture: x86_64
   CPUs: 6
   Total Memory: 1.939GiB
   Name: docker-desktop
   ID: L33G:3G5F:HIHY:FWNH:25ZM:DU35:IH2S:K4AD:6VKJ:UL3Z:IBW4:ZZY7
   Docker Root Dir: /var/lib/docker
   Debug Mode: false
   HTTP Proxy: http.docker.internal:3128
   HTTPS Proxy: http.docker.internal:3128
   Registry: https://index.docker.io/v1/
   Labels:
   Experimental: false
   Insecure Registries:
    127.0.0.0/8
   Live Restore Enabled: false

  #+end_example
- docker pull xxxxx
  å¾Docker Hubæ‹‰ä¸‹ï¼ˆä¸‹è¼‰ï¼‰æ˜ åƒæª” [æ˜ åƒæª”åç¨±xxxxx]
- docker images
  æª¢æŸ¥ç›®å‰å·²ä¸‹è¼‰ä¹‹æ˜ åƒæª”
  #+begin_src shell -r -n :results output :exports both
  docker images
  #+end_src

  #+RESULTS:
  : REPOSITORY               TAG       IMAGE ID       CREATED       SIZE
  : openvino/ubuntu18_dev    latest    5909980b90ae   8 days ago    5.63GB
  : docker/getting-started   latest    eb9194091564   9 days ago    28.5MB
  : hello-world              latest    feb5d9fea6a5   8 weeks ago   13.3kB
- docker ps
  æª¢æŸ¥ç›®å‰æ­£åœ¨åŸ·è¡Œçš„container
  #+begin_src shell -r -n :results output :exports both
  docker ps
  #+end_src

  #+RESULTS:
  : CONTAINER ID   IMAGE                   COMMAND       CREATED       STATUS       PORTS     NAMES
  : 29c22b186088   openvino/ubuntu18_dev   "/bin/bash"   9 hours ago   Up 9 hours             compassionate_heyrovsky
- docker ps -a
  æŸ¥çœ‹æ‰€æœ‰çš„container
  #+begin_src shell -r -n :results output :exports both
  docker ps -a
  #+end_src

  #+RESULTS:
  : CONTAINER ID   IMAGE                    COMMAND                  CREATED          STATUS                      PORTS     NAMES
  : 7ce134ba2f64   hello-world              "/hello"                 16 minutes ago   Exited (0) 16 minutes ago             lucid_sinoussi
  : 29c22b186088   openvino/ubuntu18_dev    "/bin/bash"              9 hours ago      Up 9 hours                            compassionate_heyrovsky
  : 43ae292225cb   docker/getting-started   "/docker-entrypoint.â€¦"   24 hours ago     Created                               charming_hofstadter
  : 07b136cc7716   docker/getting-started   "/docker-entrypoint.â€¦"   24 hours ago     Exited (0) 14 minutes ago             goofy_goldwasser
- docker start [Container ID]
  å•Ÿå‹•docker container
  #+begin_src shell -r -n :results output :exports both
  docker start 07b136cc7716
  docker ps
  #+end_src

  #+RESULTS:
  : 07b136cc7716
  : CONTAINER ID   IMAGE                    COMMAND                  CREATED        STATUS          PORTS                NAMES
  : 29c22b186088   openvino/ubuntu18_dev    "/bin/bash"              9 hours ago    Up 9 hours                           compassionate_heyrovsky
  : 07b136cc7716   docker/getting-started   "/docker-entrypoint.â€¦"   24 hours ago   Up 13 seconds   0.0.0.0:80->80/tcp   goofy_goldwasser
- docker stop [Container ID]
  åœæ­¢åŸ·è¡ŒContainer
  #+begin_src shell -r -n :results output :exports both
  docker stop 07b136cc7716
  #+end_src

  #+RESULTS:
  : 07b136cc7716
- docker rm [Container DI]
  åˆªé™¤Container
  #+begin_src shell -r -n :results output :exports both
  docker rm 7ce134ba2f64
  docker ps -a
  #+end_src

  #+RESULTS:
  : 7ce134ba2f64
  : CONTAINER ID   IMAGE                    COMMAND                  CREATED        STATUS        PORTS     NAMES
  : 29c22b186088   openvino/ubuntu18_dev    "/bin/bash"              11 hours ago   Up 11 hours             compassionate_heyrovsky
  : 43ae292225cb   docker/getting-started   "/docker-entrypoint.â€¦"   26 hours ago   Created                 charming_hofstadter
- docker rmi [Image ID]
  åˆªé™¤ image, åˆªé™¤ image å‰å¿…éœ€å°‡é€éè©² image æ‰€ç”¢ç”Ÿçš„ container ç§»é™¤
  
- docker container ls
  List containers
  #+begin_src shell -r -n :results output :exports both
  docker container ls
    #+end_src

  #+RESULTS:
  : CONTAINER ID   IMAGE                   COMMAND       CREATED       STATUS       PORTS     NAMES
  : 29c22b186088   openvino/ubuntu18_dev   "/bin/bash"   9 hours ago   Up 9 hours             compassionate_heyrovsky

-
** åˆ©ç”¨å…¬é–‹æ¨¡å‹ MobileNet åŸ·è¡Œåœ–åƒåˆ†é¡
åˆ©ç”¨ Docker å®‰è£å¥½OpenVINO å·¥ä½œç’°å¢ƒå¾Œå°±å¯ä»¥é–‹å§‹é€²è¡Œæ¨ç†(Inference)å·¥ä½œäº†ã€‚OpenVINO é™¤äº†æä¾›å¤šç¨®é è¨“ç·´å¥½çš„æ¨¡å‹å¤–[11]ï¼Œå¦å¤–ä¹Ÿæ”¯æŒå¾ˆå¤šä¸åŒæ¡†æ¶ (Caffe/Caffe2, PyTorch, TensorFlow, MXNet, ONNX ç­‰)ç”¢ç”Ÿçš„å…¬é–‹æ¨¡å‹[12]ï¼Œä¹Ÿç¨±ç‚ºã€ŒOpen Model Zooã€ï¼Œå…¶ä¸­åŒ…å«åœ–åƒåˆ†é¡ã€å°è±¡åµæ¸¬ã€åœ–åƒåˆ†å‰²ã€äººè‡‰è­˜åˆ¥ã€äººé«” å§¿æ…‹ã€æ·±åº¦ä¼°æ¸¬ã€åœ–åƒå¡«è£œã€é¢¨æ ¼è½‰ç§»ã€å‹•ä½œè­˜åˆ¥ã€åœ–åƒè‘—è‰²ã€è²éŸ³åˆ†é¡ã€èªéŸ³ è­˜åˆ¥ã€åœ–åƒç¿»è­¯ç­‰å…¬é–‹æ¨¡å‹ã€‚

ä½¿ç”¨é€™äº›æ¨¡å‹å‰é ˆå…ˆä¸‹è¼‰ä¸¦åŸ·è¡Œå„ªåŒ–ï¼Œæœ€å¾Œç”¢ç”Ÿ OpenVINO æ¨ç†æ™‚æ‰€éœ€çš„ä¸­é–“è¡¨ç¤ºæ–‡ä»¶(Intermediate Representation, IR)ï¼Œå³æ¨¡å‹æè¿°æ–‡ä»¶(*.xml)åŠåƒæ•¸æ¬Šé‡æ–‡ä»¶(*.bin)ï¼Œå­˜æ”¾åœ¨/opt/intel/openvino/public/æ¨¡å‹åç¨±/FP16(æˆ– FP32, INT8)è·¯å¾‘ä¸‹ã€‚
** mobilenet åœ–åƒåˆ†é¡
*** ä¸‹è¼‰openvion docker image
å•Ÿå‹• Docker ä¸¦æŒ‡å®šæ˜ åƒåœ¨ Intel CPU ä¸ŠåŸ·è¡Œï¼Œä»¥ root èº«ä»½åŸ·è¡Œï¼ŒåŒæ™‚æŒ‡ä»¤é¡¯ç¤ºå™¨å’Œç³»çµ±å…±äº«ï¼Œæ–¹ä¾¿ OpenCV åŸ·è¡Œimshow()èƒ½æ­£å¸¸å·¥ä½œ
#+begin_src shell -r -n :results output :exports both
docker run -itu root:root --rm -v /tmp/.X11-unix:/tmp/.X11-unix -e DISPLAY=$DISPLAY openvino/ubuntu18_dev
#+end_src
*** ä¸‹è¼‰æ¨¡å‹
#+begin_src shell -r -n :results output :exports both
python3 /opt/intel/openvino/deployment_tools/tools/model_downloader/downloader.py --name mobilenet-v1-1.0-224
#+end_src
*** å„ªåŒ–æ¨¡å‹
å„ªåŒ–mobilenet-v1-1.0-224 ä¸¦ç”¢å‡ºä¸­é–“è¡¨ç¤º(*.xml, *.bin)æ–‡ä»¶ï¼ŒFP16/FP32 æ ¼å¼æ–¼ /opt/intel/openvino/deployment_tools/public/æ¨¡å‹åç¨±è·¯å¾‘ä¸‹
#+begin_src shell -r -n :results output :exports both
python3 /opt/intel/openvino/deployment_tools/tools/model_downloader/converter.py --name mobilenet-v1-1.0-224
#+end_src
*** è¼¸å…¥åœ–ç‰‡ï¼Œæ¸¬è©¦æ¨ç†
#+begin_src shell -r -n :results output :exports both
python3 /opt/intel/openvino/inference_engine/samples/python/classification_sample_async/classification_sample_async.py -m /opt/intel/openvino/public/mobilenet-v1-1.0-224/FP16/mobilenet-v1-1.0-224.xml -i /opt/intel/openvino/deployment_tools/demo/car.png --labels /opt/intel/openvino/deployment_tools/demo/squeezenet1.1.labels
#+end_src
*** æ›æˆå…¶ä»–æ±½è»Šåœ–ç‰‡
1. åˆ‡æ›åˆ°hostä¸‹è¼‰åœ–ç‰‡, ~/Downloads/pickup.jpg
2. æŸ¥è©¢container ID
   #+begin_src shell -r -n :results output :exports both
   docker ps
   #+end_src
   #+RESULTS:
   : CONTAINER ID   IMAGE                    COMMAND                  CREATED        STATUS        PORTS                NAMES
   : 29c22b186088   openvino/ubuntu18_dev    "/bin/bash"              9 hours ago    Up 9 hours                         compassionate_heyrovsky
   : 07b136cc7716   docker/getting-started   "/docker-entrypoint.â€¦"   23 hours ago   Up 23 hours   0.0.0.0:80->80/tcp   goofy_goldwasser
3. å°‡ä¸‹è¼‰çš„åœ–ç‰‡è¤‡è£½åˆ°containerä¸­
   #+begin_src shell -r -n :results output :exports both
   docker cp ~/Downloads/pickup.jpg 29c22b186088:/opt/intel/openvino/deployment_tools/demo
   #+end_src
4. é‡æ–°æ¸¬è©¦æ¨ç†
** Docker References
[[https://makerpro.cc/2021/01/use-docker-to-develop-the-environment-of-openvino/][- å¦‚ä½•åˆ©ç”¨Dockerå¿«é€Ÿå»ºç½®OpenVINOâ„¢ Toolkité–‹ç™¼ç’°å¢ƒ]]
- [[https://philipzheng.gitbook.io/docker_practice/introduction/what][ä»€éº¼æ˜¯ Docker]]

* Install openvino notebooks
1. åƒè€ƒ:[[https://github.com/openvinotoolkit/openvino_notebooks][ openvinotoolkit / openvino_notebooks ]]
2. Create and activate a Virtual Environment
   #+begin_src shell -r -n :results output :exports both
   conda create --name openvino_env
   conda activate openvino_env
   #+end_src
3. Clone the Repository
   #+begin_src shell -r -n :results output :exports both
   cd ~/Desktop
   git clone https://github.com/openvinotoolkit/openvino_notebooks.git
   cd ~/Desktop/openvino_notebooks
   #+end_src
4. Install the Packages
   #+begin_src shell -r -n :results output :exports both
   python -m pip install --upgrade pip
   pip install -r requirements.txt
   #+end_src
   çµæœ: å®‰è£openvino-devæ™‚å¤±æ•—
   #+begin_src shell -r -n :results output :exports both
   Collecting openvino==2021.4.0
     Using cached openvino-2021.4.0-3839-cp39-cp39-macosx_10_15_x86_64.whl (25.8 MB)
   ERROR: Cannot install openvino-dev[onnx,tensorflow2]==2021.4.0, openvino-dev[onnx,tensorflow2]==2021.4.1 and openvino-dev[onnx,tensorflow2]==2021.4.2 because these package versions have conflicting dependencies.

   The conflict is caused by:
       openvino-dev[onnx,tensorflow2] 2021.4.2 depends on tensorflow~=2.4.1; extra == "tensorflow2"
       openvino-dev[onnx,tensorflow2] 2021.4.1 depends on tensorflow~=2.4.1; extra == "tensorflow2"
       openvino-dev[onnx,tensorflow2] 2021.4.0 depends on tensorflow~=2.4.1; extra == "tensorflow2"

   To fix this you could try to:
   1. loosen the range of package versions you've specified
   2. remove package versions to allow pip attempt to solve the dependency conflict
   #+end_src
5. ä¿®æ­£åŸæœ¬çš„requirements.txt
   åˆªé™¤ç¬¬ä¸€è¡Œ
6. Install IntelÂ® Distribution of OpenVINOâ„¢ toolkit from Anaconda Cloud
   [[https://docs.openvino.ai/2021.3/openvino_docs_install_guides_installing_openvino_conda.html][https://docs.openvino.ai/2021.3/openvino_docs_install_guides_installing_openvino_conda.html]]
   #+begin_src shell -r -n :results output :exports both
   conda install openvino-ie4py -c intel
   #+end_src
7. Install the virtualenv Kernel in Jupyter
   #+begin_src shell -r -n :results output :exports both
   python -m ipykernel install --user --name openvino_env
   #+end_src
8. Launch the Notebooks!
   To launch a single notebook, like the Monodepth notebook
   #+begin_src shell -r -n :results output :exports both
   jupyter notebook notebooks/201-vision-monodepth/201-vision-monodepth.ipynb
   #+end_src
   To launch all notebooks in Jupyter Lab
   #+begin_src shell -r -n :results output :exports both
   jupyter lab notebooks
   #+end_src
   In Jupyter Lab, select a notebook from the file browser using the left sidebar. Each notebook is located in a subdirectory within the notebooks directory.

** condaåŸºæœ¬èªæ³•
*** æª¢æŸ¥ç›®å‰ç’°å¢ƒ
#+begin_src shell -r -n :results output :exports both
conda env list
#+end_src

#+RESULTS:
: # conda environments:
: #
: base                  *  /Users/letranger/opt/anaconda3
: ai4y                     /Users/letranger/opt/anaconda3/envs/ai4y
: myEnv                    /Users/letranger/opt/anaconda3/envs/myEnv
:
*** å»ºç«‹æ–°ç’°å¢ƒ
#+begin_src shell -r -n :results output :exports both
conda create --name myEnv python=3.7
#+end_src

#+RESULTS:
: WARNING: A conda environment already exists at '/Users/letranger/opt/anaconda3/envs/myEnv'
: Remove existing environment (y/[n])?

*** å•Ÿå‹•è™›æ“¬ç’°å¢ƒ
#+begin_src shell -r -n :results output :exports both
activate myEnv
#+end_src

*** åˆªé™¤è™›æ“¬ç’°å¢ƒ
#+begin_src shell -r -n :results output :exports both
conda remove --name myEnv
#+end_src

#+RESULTS:



* Software
** CMake 3.13 or higher
- [[https://github.com/Kitware/CMake/releases/download/v3.21.0/cmake-3.21.0-macos-universal.dmg][Install (choose "macOS 10.13 or]] later")
- Add /Applications/CMake.app/Contents/bin to path (for default install)
** Python 3.6 - 3.7
- Install (choose 3.6.x or 3.7.x, not latest)
- Add to path
** Apple Xcode* Command Line Tools
    In the terminal, run xcode-select --install from any directory
